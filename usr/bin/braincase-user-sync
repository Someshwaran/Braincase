#!/usr/bin/ruby

$LOAD_PATH.unshift(File.dirname("/usr/share/braincase/lib/braincase"))

require 'digest/md5'
require 'logger'
require 'braincase/utils'
require 'braincase/user_sync_manager'
require 'braincase/user'

abort "Must be root" if !Braincase.is_root?

config = Braincase.config
log = Logger.new( config[:usersync][:log], "weekly" )
log.level = Logger::INFO

log.info "Starting sync"

usm = Braincase::UserSyncManager.new( config, log, Braincase::User, Digest::MD5 )
usm.sync

log.info "Finished sync"