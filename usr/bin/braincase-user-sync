#!/usr/bin/ruby

$LOAD_PATH.unshift(File.dirname("/usr/share/braincase/classes"))
$LOAD_PATH.unshift(File.dirname("/usr/share/braincase/helpers"))

require 'digest/md5'
require 'logger'
require 'braincase/utils'
require 'braincase/user_sync_manager'
require 'braincase/user'

if !Braincase.is_root?
  puts "This script must be run as root"
  exit
end

config = Braincase::config("usersync")
log = Logger.new( config[:log], "weekly" )
log.level = Logger::INFO

usm = Braincase::UserSyncManager.new( config, log, Braincase::User, Digest::MD5 )
usm.sync