#!/bin/bash

# Author:	Robert McLeod
# Date:		21 August 2012
# Desc:		Backs up all braincase users on the system

# Function to run the backups
function run_backups() {
	
	# Get a list of all the braincase users
	USERS=`find /home -maxdepth 2 -name .braincase -type d 2> /dev/null | cut -d'/' -f3|tr -s '\n' ' '`;

	# Run through all the users
	for user in $USERS; do
	  braincase-backup-user $user;
	  braincase-export-backup $user;
	done;
}

# Check the args
case $1 in
"--run")
	run_backups;
	;;
*)
	echo "Usage: braincase-backup --run";
	;;
esac;